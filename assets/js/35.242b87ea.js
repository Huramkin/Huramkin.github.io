(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{308:function(s,a,e){"use strict";e.r(a);var t=e(5),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("平时会使用到一些动态ip主机,或者是有自己的NAS,都需要使用DDNS")]),s._v(" "),e("p",[s._v("设置DDNS如果有自己的域名就很容易,国内的阿里腾讯的云服务,海外有CF和HE等的解析服务,都可以用简单的脚本实现ddns")]),s._v(" "),e("p",[s._v("但是有些时候没有充裕的域名资源进行ddns设置,这时就需要用到免费的ddns服务了,这里记录的是dynu.com ddns的使用方法")]),s._v(" "),e("h2",{attrs:{id:"ddns使用方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ddns使用方法"}},[s._v("#")]),s._v(" DDNS使用方法")]),s._v(" "),e("p",[s._v("首先需要注册一个https://www.dynu.com/en-US/ 的账号,打开动态域名解析服务添加一个域名,此时ipv4地址和位置名(Location)")]),s._v(" "),e("h3",{attrs:{id:"方法1"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方法1"}},[s._v("#")]),s._v(" 方法1")]),s._v(" "),e("h4",{attrs:{id:"安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),e("p",[s._v("Red Hat 系列系统")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("rpm -ivh https://www.dynu.com/support/downloadfile/30 \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Ubuntu 16")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("URL='https://www.dynu.com/support/downloadfile/31'; FILE=`mktemp`; wget \"$URL\" -qO $FILE && sudo dpkg -i $FILE; rm $FILE\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),e("p",[s._v("配置文件位置 "),e("code",[s._v("vi /etc/dynuiuc/dynuiuc.conf")])]),s._v(" "),e("p",[s._v("配置文件内容")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("username YOURUSERNAME  # Your account username.(你的用户名)\npassword YOURPASSWORD  # Your account password or IP update password. (你的用户密码或者IP更新密码)\nlocation LOCATIONNAME  # Can be left empty. Location name can be assigned to hostnames in the control panel.(所使用域名的位置名,这里的位置名就是面板中的 Location )\nipv4 true              # Can be true or false.(开启更新ipv4地址)\nipv6 false             # Can be true or false.(关闭更新ipv6地址)\npollinterval 300       # IP update interval in seconds. Minimum is 120.(IP更新时间,最小120秒)\ndebug false            # Can be true or false\nquiet true             # Can be true or false\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("示例配置")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("username webtester\npassword somepassword\nlocation Work\nipv4 true\nipv6 false\npollinterval 300\ndebug false\nquiet true\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("编辑并保存好配置文件后,需要重启服务,命令为 "),e("code",[s._v("systemctl restart dynuiuc.service")])]),s._v(" "),e("p",[s._v("配置定时执行,以便及时更新IP地址,运行命令 "),e("code",[s._v("crontab -e")])]),s._v(" "),e("p",[s._v("在输入界面写入下面这行并保存,这里是每十分钟重启一次服务,以更新IP地址")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("*/10 * * * * systemctl restart dynuiuc.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("管理服务使用的命令")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("systemctl start dynuiuc.service   #启动服务\nsystemctl stop dynuiuc.service    #停止服务\nsystemctl restart dynuiuc.service #重启服务\nsystemctl status dynuiuc.service  #服务状态\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"查看和截断日志文件的方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看和截断日志文件的方法"}},[s._v("#")]),s._v(" 查看和截断日志文件的方法")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("查看实时日志: tail -f /var/log/dynuiuc.log\n查看日志文件: cat /var/log/dynuiuc.log\n截断日志文件: cat /dev/null > /var/log/dynuiuc.log\n查看服务状态: systemctl status dynuiuc.service -l\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"方法2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方法2"}},[s._v("#")]),s._v(" 方法2")]),s._v(" "),e("p",[s._v("Debian 系统安装 DDClient")]),s._v(" "),e("p",[s._v("更换时区并对时")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "y" |cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \napt-get install -y ntpdate;ntpdate cn.pool.ntp.org\ndate\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("安装")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("apt-get install ddclient\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("跟随安装提示,一步一步输入信息")]),s._v(" "),e("p",[s._v("如果需要修改可以直接修改配置文件")]),s._v(" "),e("p",[s._v("DDClient配置文件位于 "),e("code",[s._v("/etc/ddclient.conf")])]),s._v(" "),e("p",[s._v("测试(检查输出的公网IP是否正确):"),e("code",[s._v("ddclient -daemon=0 -debug -verbose -noquiet")])]),s._v(" "),e("p",[s._v("开启进程守护:"),e("code",[s._v("/usr/sbin/ddclient -daemon 120 -syslog")])]),s._v(" "),e("p",[s._v("默认情况下,本机记录文件中的IP不变,软件就不会更新IP,可以通过自己设置定时任务的方式修改更新时间\n设置定时任务,运行命令 "),e("code",[s._v("crontab -e")]),s._v(",输入")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("*/5 * * * * rm /var/cache/ddclient/*.* # 每5分钟删除IP更新缓存记录\n*/5 * * * * ddclient # 每5分钟更新并同步IP记录\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"方法3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方法3"}},[s._v("#")]),s._v(" 方法3")]),s._v(" "),e("p",[s._v("首先,需要安装curl")]),s._v(" "),e("p",[s._v("然后运行")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('curl "http://api.dynu.com/nic/update?hostname=example.ddnsfree.com&password=passwd"\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("把 "),e("code",[s._v("example.ddnsfree.com")]),s._v(" 改为刚申请的域名，"),e("code",[s._v("passwd")]),s._v(" 改为你账户的密码,然后执行。运行需要一点时间,需要等待.")]),s._v(" "),e("p",[s._v("直到输出 "),e("code",[s._v("good xxx.xxx.xxx.xxx")]),s._v(",ddns更新成功")]),s._v(" "),e("p",[s._v("输入命令 "),e("code",[s._v("crontab -e")])]),s._v(" "),e("p",[s._v("在接下来的界面输入下面的配置并保存")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('*/1 * * * * curl "http://api.dynu.com/nic/update?hostname=example.ddnsfree.com&password=passwd" >/dev/null 2>&1 &\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"提示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提示"}},[s._v("#")]),s._v(" 提示")]),s._v(" "),e("p",[s._v("安装crontab")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# centos\nyum install vixie-cron\nyum install crontabs\n-----------------\n# Ubuntu\napt-get install cron\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("查看计划任务状态,出现"),e("code",[s._v("Active Running")]),s._v("说明定时任务设置成功")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# Ubuntu\n/etc/init.d/cron status\n# centos\n/bin/systemctl status crond.service \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),e("blockquote",[e("p",[s._v("https://www.dynu.com/DynamicDNS/IPUpdateClient/Linux\nhttps://www.dynu.com/DynamicDNS/IPUpdateClient/DDClient\nhttps://www.pqs.pw/knowledgebase/9/DDNSdynuTTL30.html\nhttps://archive.fo/2Utuw\nhttps://www.eaavps.com/253.html\nhttps://archive.fo/ZtEOE")])])])}),[],!1,null,null,null);a.default=n.exports}}]);